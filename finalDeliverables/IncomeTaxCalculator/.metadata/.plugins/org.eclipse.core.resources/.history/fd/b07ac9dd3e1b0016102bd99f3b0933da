package outputManager;

import java.io.File;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;
import taxpayer.Taxpayer;

public class OutputManager {
	private String domain;
	private ChartCreator chartCreator = new ChartCreator();
	private InfoFileUpdater infoFileUpdater = new InfoFileUpdater();
	
	public void creatInfoXmlFile(Taxpayer taxp){
		infoFileUpdater.setDomain(domain);
		infoFileUpdater.creatInfoXmlFile(taxp);
	}
	
	public void creatLogXmlFile(Taxpayer taxp){
		ArrayList<String> myList = new ArrayList<String>();
		String fullDomain = domain + taxp.getAfm() + "_LOG.xml";
		File file = new File(fullDomain);
		
		myList.add("<Name> "  + taxp.getName() + " </Name>");
		myList.add("<AFM> " + taxp.getAfm() + " </AFM>");
		myList.add("<Income> " + taxp.getIncome() + " </Income>");
		myList.add("<BasicTax> " + taxp.getBasicTax() + " </BasicTax>");
		myList.add("<TaxIncrease> " + taxp.getTaxIncrease() + " </TaxIncrease>");
		myList.add("<TotalTax> " + taxp.getTotalTax() + " </TotalTax>");
		myList.add("<Receipts> " + taxp.getTotalReceiptsGathered() + " </Receipts>");
		myList.add("<Entertainment> " + taxp.getCategoryNumberOfReceipts("Entertainment") + " </Entertainment>");
		myList.add("<Basic> " + taxp.getCategoryNumberOfReceipts("Basic") + " </Basic>");
		myList.add("<Travel> " + taxp.getCategoryNumberOfReceipts("Travel") + " </Travel>");
		myList.add("<Health> " + taxp.getCategoryNumberOfReceipts("Health") + " </Health>");
		myList.add("<Other> " + taxp.getCategoryNumberOfReceipts("Other") + " </Other>");
		
		try{
			PrintWriter output = new PrintWriter(file);
			for(String myString: myList){
				output.println(myString);
			}
			output.close();
		}catch (IOException ex){
			System.out.printf("ERROR: %s\n", ex);
		}
	}
	
	public void creatInfoTextFile(Taxpayer taxp){
		infoFileUpdater.setDomain(domain);
		infoFileUpdater.creatInfoTextFile(taxp);
	}
	
	public void creatLogTestFile(Taxpayer taxp){
		ArrayList<String> myList = new ArrayList<String>();
		String fullDomain = domain + taxp.getAfm() + "_LOG.txt";
		File file = new File(fullDomain);
		
		myList.add("Name: "  + taxp.getName());
		myList.add("AFM: " + taxp.getAfm());
		myList.add("Income: " + taxp.getIncome());
		myList.add("Basic Tax: " + taxp.getBasicTax());
		myList.add("Tax Increase: " + taxp.getTaxIncrease());
		myList.add("Total Tax: " + taxp.getTotalTax());
		myList.add("Receipts: " + taxp.getTotalReceiptsGathered());
		myList.add("Entertainment: " + taxp.getCategoryNumberOfReceipts("Entertainment"));
		myList.add("Basic: " + taxp.getCategoryNumberOfReceipts("Basic"));
		myList.add("Travel: " + taxp.getCategoryNumberOfReceipts("Travel"));
		myList.add("Health: " + taxp.getCategoryNumberOfReceipts("Health"));
		myList.add("Other:" + taxp.getCategoryNumberOfReceipts("Other"));
		
		try{
			PrintWriter output = new PrintWriter(file);
			for(String myString: myList){
				output.println(myString);
			}
			output.close();
		}catch (IOException ex){
			System.out.printf("ERROR: %s\n", ex);
		}
	}
	
	public void createPieChart(Taxpayer taxp){
		chartCreator.createPieChart(taxp);
	}
	
	public void createBarChart(Taxpayer taxp){
		chartCreator.createBarChart(taxp);
	}
	
	public void setDomain(String domain){
		this.domain = domain;
	}
}
