
-----------------------------------------------------------------------------------------

-- ASKHSH 1


grade :: Int->Int->Int                           

grade a b
    |((a>100) || (a<0) || (b<0) || (b>20))                                         
        = (-1)
    |((c>47) && (a<48))
        = 47
    |((a>47) && (c>47) && (c<51))
        = 50
    |otherwise
        = c
    where c = ((8*a) `div` 10) + b




-----------------------------------------------------------------------------------------
     
-- ASKHSH 2

parking :: (Int,Int)->(Int,Int)->Int            
  
parking (h1,m1) (h2,m2)
    |(numH subH (m2 - m1))>0 && (numH subH (m2 - m1))<4
	-- = numH subH  (m2 - m1)
	= 8
    |(numH subH (m2 - m1))>3 && (numH subH (m2 - m1))<7
        -- = numH subH (m2 - m1)
        = 8 + 2*((numH subH (m2 - m1))-3)
    |numH subH (m2 - m1)>6
        = (numH subH (m2 - m1)) + 8
    |otherwise
	= numH subH ( m2 - m1) 
    where subH = h2 - h1

numH :: Int->Int->Int

numH subH subM
    |(subM==0)
        = subH
    |(subM > 0 && subM < 60)
	= subH + 1
    |(subM> -60 && subM<0)
	= subH
    |otherwise
        = (-1)                                     








-----------------------------------------------------------------------------------------
     
-- ASKHSH 3

digits :: Int->Int->Int

digits x y
    |(sum < 2)
        = 0
    |(sum == 2)
        = 1
    |(sum == 3)
        = 5
    |(sum == 4)
        = 20
    |(sum == 5)
        = 300
    |(sum == 6)
        = 8000
    |(sum == 7)
        = 100000
    |(sum == 8)
        = 1000000
    |otherwise
        = (-1)
    where sum = (sumDigits x y)

sumDigits :: Int->Int->Int

sumDigits 0 0 = 0
sumDigits x y
    |(x `mod` 10)/=(y `mod` 10)
        = c + 0
    |otherwise
        = c + 1
    where c = sumDigits (x `div` 10) (y `div` 10)

    







-----------------------------------------------------------------------------------------
     
-- ASKHSH 4

search :: Integer->Integer->Integer->Integer     

search a k m = -2015                








-----------------------------------------------------------------------------------------
     
-- ASKHSH 5                                   

sum2015 :: Integer->Integer->Integer             

sum2015 m n = -2015                





-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------

-- MHN TROPOPOIHSETE TO PARAKATW TMHMA KWDIKA 
-- XRHSIMEYEI GIA ELEGXO TWN SYNARTHSEWN POY 8A GRAPSETE


computeScore :: Num n => [n]->[n]->Int
computeScore a b = foldr (+) 0 (map (\n -> if n then 1 else 0) [x==y | (x,y) <- (p a b)])
            where p r s = if null r then [] else (head r,head s) : p (tail r) (tail s)  


score1 :: Int
score1 = computeScore [grade a b | (a,b)<-p] q
         where p = [(100,20),(100,0),(0,20),(80,20),(59,10),
                    (48,10),(48,9),(40,20),(20,100),(35,-2)]
               q = [100,80,20,84,57,50,47,47,-1,-1]


score2 :: Int
score2 = computeScore [parking t1 t2 | (t1,t2)<-p] q
         where p = [((13,59),(14,00)),((15,30),(16,30)),
                    ((8,45),(11,15)),((6,15),(9,14)),
                    ((12,22),(15,23)),((16,15),(21,05)),
                    ((10,55),(16,05)),((6,05),(12,15)),
                    ((8,32),(20,28)),((6,00),(22,00))]
               q = [8,8,8,8,10,12,14,15,20,24]


score3 :: Int
score3 = computeScore [digits x y | (x,y)<-p] q
         where p = [(13758455,13758455),(22812509,22852509),
                    (38954421,70954421),(42358921,42358002),
                    (12548706,14520786),(80000012,71800009),
                    (42212553,22125531),(58723493,83463738),
                    (78354623,46237835),(34578364,83648364)]
               q = [1000000,100000,8000,300,20,5,1,0,0,20]

score4 :: Int
score4 = computeScore [search a k m | (a,k,m)<-p] q
         where p = [(0,2,2),(1,2,2),(2,2,2),(2,5,2),(5,2,2),(1,10,3),
                    (1,100,2),(1000,2,3),(100,100,100),(1000,1000,1000)]
               q = [1,6,7,24,8,32,997,13,117,1108]
               

score5 :: Int
score5 = computeScore [sum2015 m n | (m,n)<-p] q
         where p = [(0,1),(0,2),(0,3),(0,10),(1,1),
                   (1,3),(1,5),(3,4),(7,10),(12,12)]
               q = [1,5,36,14914341925,2,99,12200,3697,
                    3981410573826,36520347436056576]

score :: Int
score = score1+score2+score3+score4+score5

-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
