package outputManager;

import java.io.File;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;
import taxpayer.Taxpayer;

public class InfoFileUpdater{
	private String domain;
	private Taxpayer outputManagerTaxpayer;
	
	public void createInfoTextFile(){
		
		System.out.println(domain);
		System.out.println(outputManagerTaxpayer.getReceipts().get(0).
				getReceiptCode());
		
		ArrayList<String> myList = new ArrayList<String>();
		String fullDomain = domain + outputManagerTaxpayer.getAfm() +
				"_INFO.txt";
		File file = new File(fullDomain);
		if(file.exists() && file.isFile()){
			myList.add("Name: " + outputManagerTaxpayer.getName());
			myList.add("AFM: " + outputManagerTaxpayer.getAfm());
			myList.add("Status: " + outputManagerTaxpayer.
					getFamilyStatus());
			myList.add("Income: " + outputManagerTaxpayer.
					getIncome());
			myList.add("");
			myList.add("");
			myList.add("Receipts:");
			myList.add("");
			myList.add("");
			
			for(int i=0; i<outputManagerTaxpayer.getReceipts().size();
					i++){
				myList.add("Receipt ID: " + outputManagerTaxpayer.
						getReceipts().get(i).getReceiptCode());
				myList.add("Date: " + outputManagerTaxpayer.
						getReceipts().get(i).getDateOfIssue());
				myList.add("Kind: " + outputManagerTaxpayer.
						getReceipts().get(i).getCategory());
				myList.add("Amount: " + outputManagerTaxpayer.
						getReceipts().get(i).getAmountPaid());
				myList.add("Company: " + outputManagerTaxpayer.
						getReceipts().get(i).getSeller().
						getCompanyName());
				myList.add("Country: " + outputManagerTaxpayer.
						getReceipts().get(i).getSeller().
						getCountry());
				myList.add("City: " + outputManagerTaxpayer.
						getReceipts().get(i).getSeller().getCity());
				myList.add("Street: " + outputManagerTaxpayer.
						getReceipts().get(i).getSeller().getStreet());
				myList.add("Number: " + outputManagerTaxpayer.
						getReceipts().get(i).getSeller().
						getStreetNumber());
				myList.add("");
				myList.add("");
			}
			
			try{
				PrintWriter output = new PrintWriter(file);
				for(String myString: myList){
					output.println(myString);
					System.out.println(myString);
				}
				output.close();
			}catch (IOException ex){
				System.out.printf("ERROR: %s\n", ex);
			}
		}
	}

	public void createInfoXmlFile(){
		ArrayList<String> myList = new ArrayList<String>();
		String fullDomain = domain + outputManagerTaxpayer.getAfm() +
				"_INFO.xml";
		File file = new File(fullDomain);
		if(file.exists() && file.isFile()){
			myList.add("<Name> " + outputManagerTaxpayer.getName() +
					" </Name>");
			myList.add("<AFM> " + outputManagerTaxpayer.getAfm() +
					" </AFM>");
			myList.add("<Status> " + outputManagerTaxpayer.
					getFamilyStatus() + " </Status>");
			myList.add("<Income> " + outputManagerTaxpayer.getIncome()
			+ " </Income>");
			myList.add("");
			myList.add("");
			myList.add("<Receipts>");
			myList.add("");
			myList.add("");
			
			for(int i=0; i<outputManagerTaxpayer.getReceipts().size();
					i++){
				myList.add("<ReceiptID> " + outputManagerTaxpayer.
						getReceipts().get(i).getReceiptCode() +
						" </ReceiptID>");
				myList.add("<Date> " + outputManagerTaxpayer.
						getReceipts().get(i).getDateOfIssue() +
						" </Date>");
				myList.add("<Kind> " + outputManagerTaxpayer.
						getReceipts().get(i).getCategory() +
						" </Kind>");
				myList.add("<Amount> " + outputManagerTaxpayer.
						getReceipts().get(i).getAmountPaid() +
						" </Amount>");
				myList.add("<Company> " + outputManagerTaxpayer.
						getReceipts().get(i).getSeller().
						getCompanyName() + " </Company>");
				myList.add("<Country> " + outputManagerTaxpayer.
						getReceipts().get(i).getSeller().
						getCountry() + " </Country>");
				myList.add("<City> " + outputManagerTaxpayer.
						getReceipts().get(i).getSeller().getCity() +
						" </City>");
				myList.add("<Street> " + outputManagerTaxpayer.
						getReceipts().get(i).getSeller().getStreet() +
						" </Street>");
				myList.add("<Number> " + outputManagerTaxpayer.
						getReceipts().get(i).getSeller().
						getStreetNumber() + " </Number>");
				myList.add("");
				myList.add("");
			}
			myList.add("</Receipts>");
			
			try{
				PrintWriter output = new PrintWriter(file);
				for(String myString: myList){
					output.println(myString);
				}
				output.close();
			}catch (IOException ex){
				System.out.printf("ERROR: %s\n", ex);
			}
		}
	}
	
	public void setDomain(String domain){
		this.domain = domain;
	}
	
	public void setOutputManagerTaxpayer(
			Taxpayer outputManagerTaxpayer){
		this.outputManagerTaxpayer = outputManagerTaxpayer;
	}
}